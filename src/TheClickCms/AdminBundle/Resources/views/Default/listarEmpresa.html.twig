<!doctype html>
<head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">

        <title>Admin Overtech - Mediadiv Ltda</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->


         {% include "TheClickCmsAdminBundle:Layers:cssprincipal.html.twig" %}


    </head>

    <body class="dashboard-page">
        <script>
	        var theme = $.cookie('protonTheme') || 'default';
	        $('body').removeClass (function (index, css) {
	            return (css.match (/\btheme-\S+/g) || []).join(' ');
	        });
	        if (theme !== 'default') $('body').addClass(theme);
        </script>
        <!--[if lt IE 8]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
   {% include "TheClickCmsAdminBundle:Layers:menu.html.twig" %}
        <section class="wrapper scrollable">
            <section class="title-bar">
                <div>
                    <span> Admin </span>
                    <nav class="dashboard-menu">
                        <a href="javascript:;">
                            <i class="icon-cog toggle-widget-setup"></i>
                            <i class="menu-state-icon icon-sort-up"></i>
                            <i class="menu-state-icon icon-caret-down active"></i>
                        </a>
                        <ul>
                            <li><a data-toggle="modal" href="#quickLaunchModal">Menu </a></li>
                            <li><a data-toggle="modal" href="#quickLaunchModal">Menu </a></li>
                            <li><a href="javascript:;">Third Menu Item</a></li>
                        </ul>
                    </nav>
                </div>
            </section>
            <div>
                <section class="col-md-10" style="margin-left:5%;margin-top:2%;">
	{% block listarempresa %}
		<table class="table" id="empresa">
			<thead>
				<th>Pais</th>
				<th>Nombre</th>
				<th>Detalle</th>
				<th>Correo</th>
				<th>Fecha</th>
				<th>Foto</th>
				<th>Editar</th>
				<th>Eliminar</th>
			</thead>
			<tbody>
				{% for empresa in empresa %}
					<tr id="empresa-{{empresa.id}}">
						<td>{{empresa.pais}}</td>
						<td>{{empresa.nombre}}</td>
						<td>{{empresa.detalle}}</td>
						<td>{{empresa.correo}}</td>
						<td>{{empresa.fecha | date("m/d/Y")}}</td>
						<td>



							{% if empresa.fotos %}
								{% set fotos = empresa.fotos %}
								{% for foto in fotos %}
								    <img src="../../empresas/{{empresa.id}}/{{foto.url}}" width="100" height="100" alt="{{foto.url}}" />
								{% endfor %}
							{% endif %}
						</td>
						<td><a href="vistaEditarEmpresa/{{empresa.id}}" class="btn btn-primary">Editar</a></td>
						<td> <button  id="empre-{{empresa.id}}" class="eliminar">Eliminar</button> </td>
					</tr>
				{% endfor %}
			</tbody>
		</table>
	{% endblock %}
				</section>
			</div>
			<form id="formEliminarEmpresa" method="post" action="{{path('eliminarEmpresa')}}"></form>
		</section>
		<script type="text/javascript">
		$(document).ready(function() {
			$("#empresa").on("click", ".eliminar", function(e) {
		        e.preventDefault();
		        var clickedID = this.id.split('-');
		        var DbNumberID = clickedID[1]; // toma el numero del array
		        var myData = 'recordToDelete=' + DbNumberID;
		     
		        console.log(myData);

		        
		        jQuery.ajax({
		            type: "POST",
		            url: $('#formEliminarEmpresa').attr('action'),
		            dataType: "text",
		            data: myData,
		            success: function(response) {
		              $('#empresa-' + DbNumberID).hide('slow');
		            },
		            error: function(xhr, ajaxOptions, thrownError) {
		                alert(thrownError);
		            }
        		});
    		});
		});
		</script>


		{% include "TheClickCmsAdminBundle:Layers:js.html.twig" %}
		<div id="quickLaunchModal" tabindex="-1" role="dialog" class="modal fade">
		</div>
	</body>
</html>
